<!DOCTYPE html>
<!-- saved from url=(0059)https://china-aws.qwiklabs.com/classrooms/30842/labs/166977 -->
<html lang="zh" class="mdl-js" style=""><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<script type="text/javascript" src="./AWS - Lab 5 - Automating Infrastructure Deployment with AWS CloudFormation_files/caff0d62ed"></script><script src="./AWS - Lab 5 - Automating Infrastructure Deployment with AWS CloudFormation_files/nr-1153.min.js"></script><script type="text/javascript" id="www-widgetapi-script" src="./AWS - Lab 5 - Automating Infrastructure Deployment with AWS CloudFormation_files/www-widgetapi.js" async=""></script><script>window.NREUM||(NREUM={});NREUM.info={"beacon":"bam.nr-data.net","errorBeacon":"bam.nr-data.net","licenseKey":"caff0d62ed","applicationID":"7198647","transactionName":"IQ1XRUEOVV1dFxlRXAEXSlRATkpZVxI=","queueTime":0,"applicationTime":731,"agent":""}</script>
<script>(window.NREUM||(NREUM={})).loader_config={licenseKey:"caff0d62ed",applicationID:"7198647"};window.NREUM||(NREUM={}),__nr_require=function(n,e,t){function r(t){if(!e[t]){var i=e[t]={exports:{}};n[t][0].call(i.exports,function(e){var i=n[t][1][e];return r(i||e)},i,i.exports)}return e[t].exports}if("function"==typeof __nr_require)return __nr_require;for(var i=0;i<t.length;i++)r(t[i]);return r}({1:[function(n,e,t){function r(){}function i(n,e,t){return function(){return o(n,[u.now()].concat(f(arguments)),e?null:this,t),e?void 0:this}}var o=n("handle"),a=n(4),f=n(5),c=n("ee").get("tracer"),u=n("loader"),s=NREUM;"undefined"==typeof window.newrelic&&(newrelic=s);var p=["setPageViewName","setCustomAttribute","setErrorHandler","finished","addToTrace","inlineHit","addRelease"],d="api-",l=d+"ixn-";a(p,function(n,e){s[e]=i(d+e,!0,"api")}),s.addPageAction=i(d+"addPageAction",!0),s.setCurrentRouteName=i(d+"routeName",!0),e.exports=newrelic,s.interaction=function(){return(new r).get()};var m=r.prototype={createTracer:function(n,e){var t={},r=this,i="function"==typeof e;return o(l+"tracer",[u.now(),n,t],r),function(){if(c.emit((i?"":"no-")+"fn-start",[u.now(),r,i],t),i)try{return e.apply(this,arguments)}catch(n){throw c.emit("fn-err",[arguments,this,n],t),n}finally{c.emit("fn-end",[u.now()],t)}}}};a("actionText,setName,setAttribute,save,ignore,onEnd,getContext,end,get".split(","),function(n,e){m[e]=i(l+e)}),newrelic.noticeError=function(n,e){"string"==typeof n&&(n=new Error(n)),o("err",[n,u.now(),!1,e])}},{}],2:[function(n,e,t){function r(n,e){var t=n.getEntries();t.forEach(function(n){"first-paint"===n.name?a("timing",["fp",Math.floor(n.startTime)]):"first-contentful-paint"===n.name&&a("timing",["fcp",Math.floor(n.startTime)])})}function i(n){if(n instanceof c&&!s){var e,t=Math.round(n.timeStamp);e=t>1e12?Date.now()-t:f.now()-t,s=!0,a("timing",["fi",t,{type:n.type,fid:e}])}}if(!("init"in NREUM&&"page_view_timing"in NREUM.init&&"enabled"in NREUM.init.page_view_timing&&NREUM.init.page_view_timing.enabled===!1)){var o,a=n("handle"),f=n("loader"),c=NREUM.o.EV;if("PerformanceObserver"in window&&"function"==typeof window.PerformanceObserver){o=new PerformanceObserver(r);try{o.observe({entryTypes:["paint"]})}catch(u){}}if("addEventListener"in document){var s=!1,p=["click","keydown","mousedown","pointerdown","touchstart"];p.forEach(function(n){document.addEventListener(n,i,!1)})}}},{}],3:[function(n,e,t){function r(n,e){if(!i)return!1;if(n!==i)return!1;if(!e)return!0;if(!o)return!1;for(var t=o.split("."),r=e.split("."),a=0;a<r.length;a++)if(r[a]!==t[a])return!1;return!0}var i=null,o=null,a=/Version\/(\S+)\s+Safari/;if(navigator.userAgent){var f=navigator.userAgent,c=f.match(a);c&&f.indexOf("Chrome")===-1&&f.indexOf("Chromium")===-1&&(i="Safari",o=c[1])}e.exports={agent:i,version:o,match:r}},{}],4:[function(n,e,t){function r(n,e){var t=[],r="",o=0;for(r in n)i.call(n,r)&&(t[o]=e(r,n[r]),o+=1);return t}var i=Object.prototype.hasOwnProperty;e.exports=r},{}],5:[function(n,e,t){function r(n,e,t){e||(e=0),"undefined"==typeof t&&(t=n?n.length:0);for(var r=-1,i=t-e||0,o=Array(i<0?0:i);++r<i;)o[r]=n[e+r];return o}e.exports=r},{}],6:[function(n,e,t){e.exports={exists:"undefined"!=typeof window.performance&&window.performance.timing&&"undefined"!=typeof window.performance.timing.navigationStart}},{}],ee:[function(n,e,t){function r(){}function i(n){function e(n){return n&&n instanceof r?n:n?c(n,f,o):o()}function t(t,r,i,o){if(!d.aborted||o){n&&n(t,r,i);for(var a=e(i),f=v(t),c=f.length,u=0;u<c;u++)f[u].apply(a,r);var p=s[y[t]];return p&&p.push([b,t,r,a]),a}}function l(n,e){h[n]=v(n).concat(e)}function m(n,e){var t=h[n];if(t)for(var r=0;r<t.length;r++)t[r]===e&&t.splice(r,1)}function v(n){return h[n]||[]}function g(n){return p[n]=p[n]||i(t)}function w(n,e){u(n,function(n,t){e=e||"feature",y[t]=e,e in s||(s[e]=[])})}var h={},y={},b={on:l,addEventListener:l,removeEventListener:m,emit:t,get:g,listeners:v,context:e,buffer:w,abort:a,aborted:!1};return b}function o(){return new r}function a(){(s.api||s.feature)&&(d.aborted=!0,s=d.backlog={})}var f="nr@context",c=n("gos"),u=n(4),s={},p={},d=e.exports=i();d.backlog=s},{}],gos:[function(n,e,t){function r(n,e,t){if(i.call(n,e))return n[e];var r=t();if(Object.defineProperty&&Object.keys)try{return Object.defineProperty(n,e,{value:r,writable:!0,enumerable:!1}),r}catch(o){}return n[e]=r,r}var i=Object.prototype.hasOwnProperty;e.exports=r},{}],handle:[function(n,e,t){function r(n,e,t,r){i.buffer([n],r),i.emit(n,e,t)}var i=n("ee").get("handle");e.exports=r,r.ee=i},{}],id:[function(n,e,t){function r(n){var e=typeof n;return!n||"object"!==e&&"function"!==e?-1:n===window?0:a(n,o,function(){return i++})}var i=1,o="nr@id",a=n("gos");e.exports=r},{}],loader:[function(n,e,t){function r(){if(!x++){var n=E.info=NREUM.info,e=l.getElementsByTagName("script")[0];if(setTimeout(s.abort,3e4),!(n&&n.licenseKey&&n.applicationID&&e))return s.abort();u(y,function(e,t){n[e]||(n[e]=t)}),c("mark",["onload",a()+E.offset],null,"api");var t=l.createElement("script");t.src="https://"+n.agent,e.parentNode.insertBefore(t,e)}}function i(){"complete"===l.readyState&&o()}function o(){c("mark",["domContent",a()+E.offset],null,"api")}function a(){return O.exists&&performance.now?Math.round(performance.now()):(f=Math.max((new Date).getTime(),f))-E.offset}var f=(new Date).getTime(),c=n("handle"),u=n(4),s=n("ee"),p=n(3),d=window,l=d.document,m="addEventListener",v="attachEvent",g=d.XMLHttpRequest,w=g&&g.prototype;NREUM.o={ST:setTimeout,SI:d.setImmediate,CT:clearTimeout,XHR:g,REQ:d.Request,EV:d.Event,PR:d.Promise,MO:d.MutationObserver};var h=""+location,y={beacon:"bam.nr-data.net",errorBeacon:"bam.nr-data.net",agent:"js-agent.newrelic.com/nr-1153.min.js"},b=g&&w&&w[m]&&!/CriOS/.test(navigator.userAgent),E=e.exports={offset:f,now:a,origin:h,features:{},xhrWrappable:b,userAgent:p};n(1),n(2),l[m]?(l[m]("DOMContentLoaded",o,!1),d[m]("load",r,!1)):(l[v]("onreadystatechange",i),d[v]("onload",r)),c("mark",["firstbyte",f],null,"api");var x=0,O=n(6)},{}],"wrap-function":[function(n,e,t){function r(n){return!(n&&n instanceof Function&&n.apply&&!n[a])}var i=n("ee"),o=n(5),a="nr@original",f=Object.prototype.hasOwnProperty,c=!1;e.exports=function(n,e){function t(n,e,t,i){function nrWrapper(){var r,a,f,c;try{a=this,r=o(arguments),f="function"==typeof t?t(r,a):t||{}}catch(u){d([u,"",[r,a,i],f])}s(e+"start",[r,a,i],f);try{return c=n.apply(a,r)}catch(p){throw s(e+"err",[r,a,p],f),p}finally{s(e+"end",[r,a,c],f)}}return r(n)?n:(e||(e=""),nrWrapper[a]=n,p(n,nrWrapper),nrWrapper)}function u(n,e,i,o){i||(i="");var a,f,c,u="-"===i.charAt(0);for(c=0;c<e.length;c++)f=e[c],a=n[f],r(a)||(n[f]=t(a,u?f+i:i,o,f))}function s(t,r,i){if(!c||e){var o=c;c=!0;try{n.emit(t,r,i,e)}catch(a){d([a,t,r,i])}c=o}}function p(n,e){if(Object.defineProperty&&Object.keys)try{var t=Object.keys(n);return t.forEach(function(t){Object.defineProperty(e,t,{get:function(){return n[t]},set:function(e){return n[t]=e,e}})}),e}catch(r){d([r])}for(var i in n)f.call(n,i)&&(e[i]=n[i]);return e}function d(e){try{n.emit("internal-error",e)}catch(t){}}return n||(n=i),t.inPlace=u,t.flag=a,t}},{}]},{},["loader"]);</script>
<meta content="[]" name="active-experiments">
<meta content="{&quot;userId&quot;:318010}" name="help-api-product-data">
<meta name="csrf-param" content="authenticity_token">
<meta name="csrf-token" content="nJRjCKC7tbwqn/kFKgHTZS+kTasHmQ5+dfLGAA+idTH/dD5YsgZeIWF855VD4cE6V5H50Yv97HR534p4puSKiA==">
<title>Architecting on AWS - Lab 5 - Automating Infrastructure Deployment with AWS CloudFormation | Qwiklabs</title>
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1, user-scalable=0" name="viewport">
<meta content="This lab shows how to deploy AWS infrastructure using AWS CloudFormation." name="description">
<meta content="Qwiklabs" name="author">
<meta content="1rRsY0INj8RvwB5EF5pwdxt2A2P9aDgAlsICaJ0d5w0" name="google-site-verification">
<meta content="Architecting on AWS - Lab 5 - Automating Infrastructure Deployment with AWS CloudFormation | Qwiklabs" property="og:title">
<meta content="website" property="og:type">
<meta content="/favicon-144.png" property="og:image">
<meta content="Qwiklabs" property="og:site_name">
<meta content="This lab shows how to deploy AWS infrastructure using AWS CloudFormation." property="og:description">
<meta content="/qwiklabs_logo_900x887.png" property="og:logo" size="900x887">
<meta content="/qwiklabs_logo_994x187.png" property="og:logo" size="994x187">
<meta content="#3681E4" property="msapplication-TileColor">
<meta content="/favicon-144.png" property="msapplication-TileImage">
<link href="https://china-aws.qwiklabs.com/favicon-32.png" rel="shortcut icon">
<link color="#3681E4" href="https://china-aws.qwiklabs.com/favicon-svg.svg" rel="mask-icon">
<link href="https://china-aws.qwiklabs.com/favicon-180.png" rel="apple-touch-icon-precomposed">
<link rel="stylesheet" media="screen" href="./AWS - Lab 5 - Automating Infrastructure Deployment with AWS CloudFormation_files/css">

<link rel="stylesheet" media="screen" href="./AWS - Lab 5 - Automating Infrastructure Deployment with AWS CloudFormation_files/zh-baa812484310685c34f060fc93a4033f915219f35ede62badd48dfc59334e103.css">
<!--[if lt IE 9]>
<script src='http://html5shim.googlecode.com/svn/trunk/html5.js' type='text/javascript'></script>
<![endif]-->
<!--[endif]>  <![endif]-->
<script>
//<![CDATA[
window.gon={};gon.current_user={"firstname":"Alpha","lastname":"Wang","fullname":"Alpha Wang","company":"Coupang","email":"awang@coupang.com","origin":"china-aws, direct","subscriptions":0,"id":"5a6928df14236eb34d3e60852bd714db","qlCreatedAt":"2019-12-05 07:02:39 UTC","optIn":true};gon.segment=null;gon.deployment="china-aws";
//]]>
</script>
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "WebSite",
  "url": "https://www.qwiklabs.com/",
  "potentialAction": {
    "@type": "SearchAction",
    "target": "https://www.qwiklabs.com/catalog?keywords={search_term_string}",
    "query-input": "required name=search_term_string"
  }
}
</script>
<script id="ze-snippet" src="./AWS - Lab 5 - Automating Infrastructure Deployment with AWS CloudFormation_files/snippet.js"></script><script type="text/javascript" src="./AWS - Lab 5 - Automating Infrastructure Deployment with AWS CloudFormation_files/asset_composer.5d2cd6d9613b85125812.js" charset="utf-8" async=""></script>



<link rel="stylesheet" media="all" href="./AWS - Lab 5 - Automating Infrastructure Deployment with AWS CloudFormation_files/application-a53cf05bc9e39a99a1d6fa14f486d7ecec091bb67f0aca5b1257120cbf85ec76.css">
<script>
  EVENT_SOURCE_BASE_URL = "https://china-aws.qwiklabs.com/nchan-sub?id=";
</script>
<script src="./AWS - Lab 5 - Automating Infrastructure Deployment with AWS CloudFormation_files/webcomponents-loader.js"></script>
<script src="./AWS - Lab 5 - Automating Infrastructure Deployment with AWS CloudFormation_files/hallofmirrors-0ecc40b22ffa59a068e7d11793e27822439d8d266fcf33fd5a8cc0f562a65a1d.js"></script><script async="" src="./AWS - Lab 5 - Automating Infrastructure Deployment with AWS CloudFormation_files/lazy.min.js"></script>
<script src="./AWS - Lab 5 - Automating Infrastructure Deployment with AWS CloudFormation_files/iframe_api"></script>
<script src="./AWS - Lab 5 - Automating Infrastructure Deployment with AWS CloudFormation_files/vendor-45d462772c30000424907184f70c7157e95fb6227698d1671c5051818a6f60d8.js"></script>
<script src="./AWS - Lab 5 - Automating Infrastructure Deployment with AWS CloudFormation_files/application-b19a78a33162e21e69548c829637ee074da544a00456ffbc7388e16ea7e81624.js"></script>
</head>
<body class="focuses focuses-show lab-show l-full no-nav" style="">
<div class="header-container" style="">
<div class="header">
<a class="mdl-button mdl-button--icon mdl-js-button mdl-js-ripple-effect header__button header__button--nav header__nav-panel-button js-nav-toggle" data-upgraded=",MaterialButton,MaterialRipple">
<i class="material-icons">menu</i>
<span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span></a>
<div class="header__title">
<a class="mdl-button mdl-js-button mdl-button--icon mdl-js-ripple-effect header__button header__button--nav" href="https://china-aws.qwiklabs.com/classrooms/30842" data-upgraded=",MaterialButton,MaterialRipple"><ql-icon>arrow_back</ql-icon><span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span></a>

<h1 class="headline-5">
Architecting on AWS - Lab 5 - Automating Infrastructure Deployment with AWS CloudFormation
</h1>
</div>
<div class="header__actions">

<ql-help context="lab" productdata="{&quot;userId&quot;:318010}"></ql-help>
<a class="header-my-account-button mdl-button mdl-button--icon mdl-js-button mdl-js-ripple-effect js-my-account-button" data-upgraded=",MaterialButton,MaterialRipple">
<img class="avatar " src="./AWS - Lab 5 - Automating Infrastructure Deployment with AWS CloudFormation_files/b6f5d11bbaf7e1f9b7c837dbbd63fb3a.png">
<span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span></a>
<div class="header-my-account-menu js-my-account-menu">
<div class="card elevation-2 no-padding">
<div class="my-account-menu__top">
<img class="avatar " src="./AWS - Lab 5 - Automating Infrastructure Deployment with AWS CloudFormation_files/b6f5d11bbaf7e1f9b7c837dbbd63fb3a.png">
<div class="my-account-menu__info">
<h4 class="subtitle-headline-1">
Alpha Wang
</h4>
<p class="body-2 text--gray">
<span>awang@coupang.com</span>
</p>
<a class="button" href="https://china-aws.qwiklabs.com/my_account/profile">我的账户</a>
</div>
</div>
<div class="my-account-menu__bottom">
<a class="button button--hairline" rel="nofollow" data-method="delete" href="https://china-aws.qwiklabs.com/users/sign_out">退出</a>
</div>
</div>
</div>

</div>
</div>
</div>

<nav class="nav-bar">
<a class="nav-bar__item js-navigation-button" href="https://china-aws.qwiklabs.com/"><ql-icon class="nav-bar__item__icon">
home
</ql-icon>
<span class="nav-bar__item__label">
Home
</span>
</a>
<a class="nav-bar__item js-navigation-button" href="https://china-aws.qwiklabs.com/catalog"><ql-icon class="nav-bar__item__icon">
school
</ql-icon>
<span class="nav-bar__item__label">
Catalog
</span>
</a>
<a class="nav-bar__item js-navigation-button  active" aria-current="page" href="https://china-aws.qwiklabs.com/my_learning"><ql-icon class="nav-bar__item__icon">
event_note
</ql-icon>
<span class="nav-bar__item__label">
My Learning
</span>
</a>
</nav>

<nav class="nav-panel js-nav-panel">
<div class="nav-panel__logo">
<div class="custom-logo"><img src="./AWS - Lab 5 - Automating Infrastructure Deployment with AWS CloudFormation_files/AWS-Logo-Sized.png"></div>
</div>
<a title="Home" tabindex="-1" class="nav-panel__item js-navigation-button" href="https://china-aws.qwiklabs.com/"><ql-icon class="nav-panel__item__icon">
home
</ql-icon>
<div class="nav-panel__item__label">
Home
</div>
</a>
<a title="Catalog" tabindex="-1" class="nav-panel__item js-navigation-button" href="https://china-aws.qwiklabs.com/catalog"><ql-icon class="nav-panel__item__icon">
school
</ql-icon>
<div class="nav-panel__item__label">
Catalog
</div>
</a>
<a title="My Learning" tabindex="-1" class="nav-panel__item js-navigation-button active" aria-current="page" href="https://china-aws.qwiklabs.com/my_learning"><ql-icon class="nav-panel__item__icon">
event_note
</ql-icon>
<div class="nav-panel__item__label">
My Learning
</div>
</a>
<div class="nav-panel__spacer"></div>
<a title="Profile" tabindex="-1" class="nav-panel__item js-navigation-button" href="https://china-aws.qwiklabs.com/my_account/profile"><ql-icon class="nav-panel__item__icon">
account_circle
</ql-icon>
<div class="nav-panel__item__label">
Profile
</div>
</a>
<a title="Credits &amp; Subscriptions" tabindex="-1" class="nav-panel__item js-navigation-button" href="https://china-aws.qwiklabs.com/my_account/credits"><ql-icon class="nav-panel__item__icon">
money
</ql-icon>
<div class="nav-panel__item__label">
Credits &amp; Subscriptions
</div>
</a>
<a title="Security" tabindex="-1" class="nav-panel__item js-navigation-button" href="https://china-aws.qwiklabs.com/my_account/security"><ql-icon class="nav-panel__item__icon">
security
</ql-icon>
<div class="nav-panel__item__label">
Security
</div>
</a>
<div class="nav-panel__spacer"></div>
<a class="nav-panel__item" tabindex="-1" href="https://china-aws.qwiklabs.com/classrooms/30842/labs/166977#"><ql-help>
<div class="nav-panel__help-item">
<ql-icon class="nav-panel__item__icon">help</ql-icon>
<div class="nav-panel__item__label">Help</div>
</div>
</ql-help>
</a><div class="nav-panel__small-links">
<a tabindex="-1" href="https://china-aws.qwiklabs.com/privacy_policy">隐私政策</a>
<a tabindex="-1" href="https://china-aws.qwiklabs.com/terms_of_service">服务条款</a>
</div>
</nav>
<div class="nav-panel__overlay js-nav-toggle"></div>

<main class="">


<div class="l-main-wrapper" id="main-wrapper">









<div class="">
<div class="js-lab-content lab-content">
<div class="alert alert--fake js-alert">
<p class="alert__message js-alert-message"></p>
<a class="alert__close js-alert-close">
<i class="fa fa-times"></i>
</a>
<iframe class="l-ie-iframe-fix" src="./AWS - Lab 5 - Automating Infrastructure Deployment with AWS CloudFormation_files/saved_resource.html"></iframe>
</div>
<div class="lab-content__markdown-wrapper">
<div class="lab-preamble">
<h1 class="lab-preamble__title">
Architecting on AWS - Lab 5 - Automating Infrastructure Deployment with AWS CloudFormation
</h1>
<div class="lab-preamble__details subtitle-headline-1">
<span>小时 </span>
<span>免费</span>
<div class="lab__rating">
<a href="https://china-aws.qwiklabs.com/focuses/166977/reviews?parent=catalog"><div class="rateit" data-rateit-readonly="true" data-rateit-value="4.5889"><div class="rateit-reset" style="display: none;"></div><div class="rateit-range" style="width: 80px; height: 16px;"><div class="rateit-selected" style="height: 16px; width: 73.4224px;"></div><div class="rateit-hover" style="height:16px"></div></div></div>

</a><a data-target="#lab-review-modal" data-toggle="modal">
我的评级
</a>
</div>
</div>
</div>

<div class="lab-content__inner-wrapper">
<div class="js-markdown-instructions lab-content__markdown markdown-lab-instructions" id="markdown-lab-instructions">
<p><img src="./AWS - Lab 5 - Automating Infrastructure Deployment with AWS CloudFormation_files/aws-logo.png" alt=""></p>



<p>© 2019 Amazon Web Services, Inc. and its affiliates. All rights reserved. This work may not be reproduced or redistributed, in whole or in part, without prior written permission from Amazon Web Services, Inc. Commercial copying, lending, or selling is prohibited.</p>

<p>Errors or corrections? Email us at <a href="mailto:aws-course-feedback@amazon.com" target="_blank">aws-course-feedback@amazon.com</a>.</p>

<p>Other questions? Contact us at <a href="https://aws.amazon.com/contact-us/aws-training/" target="_blank">https://aws.amazon.com/contact-us/aws-training/</a></p>

<p>Deploying infrastructure in a consistent, reliable manner is difficult — it requires people to follow documented procedures without taking any undocumented shortcuts. Plus, it can be difficult to deploy infrastructure out-of-hours when less staff are available. AWS CloudFormation changes this by defining infrastructure in a template that can be automatically deployed — even on an automated schedule.</p>

<p>This lab shows how to deploy multiple layers of infrastructure with CloudFormation, update a stack and delete a stack (while retaining some resources).</p>

<p>In this lab you will:</p>
<ul>
<li>Use AWS CloudFormation to deploy a VPC networking layer</li>
<li>Use AWS CloudFormation to deploy an application layer that references the networking layer</li>
<li>Explore templates with AWS CloudFormation Designer</li>
<li>Delete a stack that has a Deletion Policy</li>
</ul>
<p><strong>Duration</strong></p>

<p>This lab will require approximately <strong>20 minutes</strong> to complete.</p>



<h2 id="step1">Start Lab</h2>
<ol start="1">
<li>At the top of your screen, launch your lab by clicking <span style="background-color:#34A853;font-family:Google Sans;font-weight:bold;font-size:90%;color:white;border-color:#34A853;border-radius:4px;border-width:2px;border-style:solid;padding-top:5px;padding-bottom:5px;padding-left:10px;padding-right:10px;">Start Lab</span>
</li>
</ol>
<p>This will start the process of provisioning your lab resources. An estimated amount of time to provision your lab resources will be displayed. You must wait for your resources to be provisioned before continuing.</p>

<p><i class="fas fa-info-circle"></i> If you are prompted for a token, use the one distributed to you (or credits you have purchased). </p>
<ol start="2">
<li><p>Open your lab by clicking <span style="background-color:white;font-family:Google Sans;font-weight:bold;font-size:90%;color:#1a73e8;border-color:#dadce0;border-radius:4px;border-width:2px;border-style:solid;padding-top:5px;padding-bottom:5px;padding-left:10px;padding-right:10px;">Open Console</span><br>
This will open an AWS Management Console sign-in page.</p></li>
<li><p>On the Sign-in page, configure:</p></li>
</ol><ul>
<li>
<strong>IAM user name:</strong> <input readonly="" class="copyable-inline-input" size="10" type="text" value="awsstudent">
</li>
<li>
<strong>Password:</strong> Paste the value of <strong>Password</strong> located to the left of these instructions.</li>
<li>Click <span style="background-color:#257ACF;font-weight:bold;font-size:90%;color:white;border-radius:5px;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space: nowrap;">Sign In</span>
</li>
</ul>
<p><i class="fas fa-exclamation-triangle"></i> <strong>Please do not change the Region unless instructed</strong>.</p>



<h3>Common login errors</h3>

<p><strong>Error: You must first log out</strong></p>

<p><img src="./AWS - Lab 5 - Automating Infrastructure Deployment with AWS CloudFormation_files/logouterror.png" alt=""></p>

<p>If you see the message, <strong>You must first log out before logging into a different AWS account:</strong> </p>
<ul>
<li>Click <strong>click here</strong>
</li>
<li>Close your browser tab to return to your initial Qwiklabs window</li>
<li>Click <span style="background-color:white;font-family:Google Sans;font-weight:bold;font-size:90%;color:#1a73e8;border-color:#dadce0;border-radius:4px;border-width:2px;border-style:solid;padding-top:5px;padding-bottom:5px;padding-left:10px;padding-right:10px;">Open Console</span> again</li>
</ul>




<h2 id="step2">Task 1: Deploy a Networking Layer</h2>

<p>It is a best-practice recommendation to deploy infrastructure in <em>layers</em>. Common layers are:</p>
<ul>
<li>Network (Amazon VPC)</li>
<li>Database</li>
<li>Application</li>
</ul>
<p>This way, templates can be re-used between systems, such as deploying a common network topology between Dev/Test/Production or deploying a standard database for multiple application.</p>

<p>In this task, you will deploy an AWS CloudFormation template that creates a <em>Networking layer</em> using Amazon VPC.</p>
<ol start="4">
<li>Right-click this link and download the template to your computer: <a href="https://us-west-2-tcprod.s3.amazonaws.com/courses/ILT-TF-100-ARCHIT/v6.5.3/lab-5-cloudformation/scripts/lab-network.yaml" target="_blank">lab-network.yaml</a>
</li>
</ol>
<p><i class="fas fa-comment"></i> If you wish, you can open the template in a text editor to see how resources are defined.</p>

<p>Templates can be written in JSON or YAML. YAML is a markup language similar to JSON, but is easier to read and edit.</p>
<ol start="5">
<li><p>In the <strong>AWS Management Console</strong>, on the <span style="background-color:#232f3e;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Services <i class="fas fa-angle-down"></i></span> menu, click <strong>CloudFormation</strong>.</p></li>
<li><p>If you see this message, click <span style="color:blue;">Try it out now and provide us feedback</span>:</p></li>
</ol>
<p><img src="./AWS - Lab 5 - Automating Infrastructure Deployment with AWS CloudFormation_files/new-console.png" alt="New Console"></p>
<ol start="7">
<li>Click <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space: nowrap;">Create stack</span> and configure:</li>
</ol>
<p><strong>Step 1: Specify template</strong></p>
<ul>
<li>
<strong>Template source:</strong> <span style="font-weight:bold;background-color:#f1faff;font-size:90%;border-color:#00A1C9;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;"><i class="far fa-dot-circle" style="color:#007dbc;"></i> Upload a template file</span>
</li>
<li>
<strong>Upload a template file:</strong> Click <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Choose file</span> then select the <strong>lab-network.yaml</strong> file you downloaded.</li>
<li>Click <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space: nowrap;">Next</span>
</li>
</ul>
<p><strong>Step 2: Create Stack</strong></p>
<ul>
<li>
<strong>Stack name:</strong> <input readonly="" class="copyable-inline-input" size="11" type="text" value="lab-network">
</li>
<li>Click <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space: nowrap;">Next</span>
</li>
</ul>
<p><strong>Step 3: Configure stack options</strong></p>
<ul>
<li>Tags:
<ul>
<li>
<strong>Key:</strong> <input readonly="" class="copyable-inline-input" size="11" type="text" value="application">
</li>
<li>
<strong>Value:</strong> <input readonly="" class="copyable-inline-input" size="9" type="text" value="inventory">
</li>
</ul>
</li>
<li>Click <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space: nowrap;">Next</span>
</li>
</ul>
<p><strong>Step 4: Review lab-application</strong></p>
<ul>
<li>Click <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space: nowrap;">Create stack</span>
</li>
</ul>
<p>The <strong>template</strong> will now be used by CloudFormation to generate a <strong>stack</strong> of resources.</p>

<p>The specified <strong>tags</strong> will be automatically propagated to the resources that are created, making it easier to identify resources used by particular applications.</p>
<ol start="8">
<li><p>Click the <strong>Stack info</strong> tab.</p></li>
<li><p>Wait for the <strong>Status</strong> to change to <span style="color: green;"><i class="far fa-check-circle"></i>&nbsp;UPDATE_COMPLETE</span>.</p></li>
</ol>
<p><i class="fas fa-comment"></i> Click Refresh <i class="fas fa-redo"></i> every 15 seconds to update the display if necessary.</p>

<p>You can now examine the resources that were created.</p>
<ol start="10">
<li>Click the <strong>Resources</strong> tab.</li>
</ol>
<p>You will see a list of the resources created by the template.</p>

<p><i class="fas fa-comment"></i> If the list is empty, click Refresh <i class="fas fa-redo"></i> to update the list.</p>
<ol start="11">
<li>Click the <strong>Events</strong> tab and scroll through the listing.</li>
</ol>
<p>The listing shows (in reverse order) the activities performed by CloudFormation, such as starting to create a resource and then completing the resource creation. Any errors encountered during the creation of the stack will be listed in this tab.</p>
<ol start="12">
<li>Click the <strong>Outputs</strong> tab.</li>
</ol>
<p>A CloudFormation stack can provide <em>output information</em>, such as the ID of specific resources and links to resources.</p>

<p>You will see two outputs:</p>
<ul>
<li>
<strong>PublicSubnet:</strong>  The ID of the Public Subnet that was created (eg <em>subnet-08aafd57f745035f1</em>)</li>
<li>
<strong>VPC:</strong> The ID of the VPC that was created (eg <em>vpc-08e2b7d1272ee9fb4</em>)</li>
</ul>
<p>Outputs can also provide values that will be used by other stacks. This is shown in the <strong>Export name</strong> column. In this case, the VPC and Subnet IDs are given an export name so that other stacks can retrieve the values and build resources inside the VPC and Subnet. You will be using these values in the next task.</p>
<ol start="13">
<li>Click the <strong>Template</strong> tab.</li>
</ol>
<p>This tab shows the template that was used to create the stack. It shows the template that you uploaded while creating the stack. Feel free to examine the template and see the resources that were created, and the <strong>Outputs</strong> section at the end that defined which values to export.</p>



<h2 id="step3">Task 2: Deploy an Application Layer</h2>

<p>Now that the <em>network layer</em> has been deployed, you will deploy an <em>application layer</em> that contains an Amazon EC2 instance and a Security Group.</p>

<p>The CloudFormation template will <em>import</em> the VPC and Subnet IDs from the <em>Outputs</em> of the existing CloudFormation stack. It will then use this information to create the Security Group in the VPC and the EC2 instance in the Subnet.</p>
<ol start="14">
<li>Right-click this link and download the template to your computer: <a href="https://us-west-2-tcprod.s3.amazonaws.com/courses/ILT-TF-100-ARCHIT/v6.5.3/lab-5-cloudformation/scripts/lab-application.yaml" target="_blank">lab-application.yaml</a>
</li>
</ol>
<p><i class="fas fa-comment"></i> If you wish, you can open the template in a text editor to see how resources are defined.</p>
<ol start="15">
<li><p>In the left navigation pane, click <strong>Stacks</strong>.</p></li>
<li><p>Click <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space: nowrap;">Create stack</span> and configure:</p></li>
</ol>
<p><strong>Step 1: Specify template</strong></p>
<ul>
<li>
<strong>Template source:</strong> <span style="font-weight:bold;background-color:#f1faff;font-size:90%;border-color:#00A1C9;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;"><i class="far fa-dot-circle" style="color:#007dbc;"></i> Upload a template file</span>
</li>
<li>
<strong>Upload a template file:</strong> Click <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Choose file</span> then select the <strong>lab-application.yaml</strong> file you downloaded.</li>
<li>Click <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space: nowrap;">Next</span>
</li>
</ul>
<p><strong>Step 2: Create Stack</strong></p>
<ul>
<li>
<strong>Stack name:</strong> <input readonly="" class="copyable-inline-input" size="15" type="text" value="lab-application">
</li>
<li>
<strong>NetworkStackName:</strong> <input readonly="" class="copyable-inline-input" size="11" type="text" value="lab-network">
</li>
<li>Click <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space: nowrap;">Next</span>
</li>
</ul>
<p><i class="fas fa-comment"></i> The <em>Network Stack Name</em> parameter tells the template the name of the first stack you created (<em>lab-network</em>) so that it can retrieve values from the <em>Outputs</em>.</p>

<p><strong>Step 3: Configure stack options</strong></p>
<ul>
<li>Tags:
<ul>
<li>
<strong>Key:</strong> <input readonly="" class="copyable-inline-input" size="11" type="text" value="application">
</li>
<li>
<strong>Value:</strong> <input readonly="" class="copyable-inline-input" size="9" type="text" value="inventory">
</li>
</ul>
</li>
<li>Click <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space: nowrap;">Next</span>
</li>
</ul>
<p><strong>Step 4: Review lab-network</strong></p>
<ul>
<li>Click <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space: nowrap;">Create stack</span>
</li>
</ul>
<p>While the stack is being created, examine the <strong>Events</strong> and <strong>Resources</strong> tab to view the resources that are being created.</p>
<ol start="17">
<li>Wait for the <strong>Status</strong> (in the <em>Stack info</em> tab) to change to <span style="color: green;"><i class="far fa-check-circle"></i>&nbsp;CREATE_COMPLETE</span>.</li>
</ol>
<p>Your application is now ready!</p>
<ol start="18">
<li><p>Click the <strong>Outputs</strong> tab.</p></li>
<li><p>Copy the <strong>URL</strong> that is displayed, then open a new web browser tab, paste the URL and press Enter.</p></li>
</ol>
<p>A new browser tab will open, taking you to the application running on the web server.</p>

<p>A CloudFormation stack can also reference values from another CloudFormation stack. For example, here is a portion of the <em>lab-application</em> template that references the <em>lab-network</em> template:</p>
<pre class="highlight yaml"><code>  <span class="na">WebServerSecurityGroup</span><span class="pi">:</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">AWS::EC2::SecurityGroup</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">GroupDescription</span><span class="pi">:</span> <span class="s">Enable HTTP ingress</span>
      <span class="na">VpcId</span><span class="pi">:</span>
        <span class="s">Fn::ImportValue</span><span class="pi">:</span>
          <span class="kt">!Sub</span> <span class="s">${NetworkStackName}-VPCID</span>
</code><button class="button button--copy js-copy-button-0"><i class="fa fa-clipboard"></i></button></pre>
<p>The last line uses to the <em>Network Stack Name</em> that you provided ("lab-network") when the stack was created. It then imports the value of <em>lab-network-VPCID</em> from the Outputs of the first stack and inserts the value into the VPC ID field of the security group definition. The result is that the security group is created in the VPC created by the first stack.</p>

<p>In another example, here is the code that places the Amazon EC2 instance into the correct subnet:</p>
<pre class="highlight yaml"><code>  <span class="na">SubnetId</span><span class="pi">:</span>
    <span class="s">Fn::ImportValue</span><span class="pi">:</span>
    <span class="kt">!Sub</span> <span class="s">${NetworkStackName}-SubnetID</span>
</code><button class="button button--copy js-copy-button-1"><i class="fa fa-clipboard"></i></button></pre>
<p>It takes the Subnet ID from the <em>lab-network</em> stack and uses it in the <em>lab-application</em> stack to launch the instance into the public subnet that created by the first stack.</p>

<p>This demonstrates how multiple CloudFormation stacks can be used to deploy infrastructure in <em>multiple layers</em>.</p>



<h2 id="step4">Task 3: Update a Stack</h2>

<p>CloudFormation can also <em>update</em> a stack that has been deployed. When updating a stack, CloudFormation will only modify or replace the resources that are being changed. Any resources that are not being changed will be left as-is.</p>

<p>In this task, you will update the <em>lab-application</em> stack to modify a setting in the Security Group. CloudFormation will leave all other resources as-is, without being modified by the update.</p>

<p>First, you will examine the current settings on the Security Group.</p>
<ol start="20">
<li><p>In the <strong>AWS Management Console</strong>, on the <span style="background-color:#232f3e;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Services <i class="fas fa-angle-down"></i></span> menu, click <strong>EC2</strong>.</p></li>
<li><p>In the left navigation pane, click <strong>Security Groups</strong>.</p></li>
<li><p>Select <i class="far fa-check-square"></i> <strong>Web Server Security Group</strong>.</p></li>
<li><p>Click the <strong>Inbound</strong> tab.</p></li>
</ol>
<p>You will see that there is currently only one rule in the Security Group, which permits <em>HTTP</em> traffic.</p>

<p>You will now return to CloudFormation to update the stack.</p>
<ol start="24">
<li><p>On the <span style="background-color:#232f3e;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Services <i class="fas fa-angle-down"></i></span> menu, click <strong>CloudFormation</strong>.</p></li>
<li><p>Right-click this link and download the updated template to your computer: <a href="https://us-west-2-tcprod.s3.amazonaws.com/courses/ILT-TF-100-ARCHIT/v6.5.3/lab-5-cloudformation/scripts/lab-application2.yaml" target="_blank">lab-application2.yaml</a></p></li>
</ol>
<p>This template has an additional configuration to permit inbound SSH traffic on port 22:</p>
<pre class="highlight yaml"><code>  <span class="pi">-</span> <span class="na">IpProtocol</span><span class="pi">:</span> <span class="s">tcp</span>
    <span class="na">FromPort</span><span class="pi">:</span> <span class="s">22</span>
    <span class="na">ToPort</span><span class="pi">:</span> <span class="s">22</span>
    <span class="na">CidrIp</span><span class="pi">:</span> <span class="s">0.0.0.0/0</span>
</code><button class="button button--copy js-copy-button-2"><i class="fa fa-clipboard"></i></button></pre><ol start="26">
<li><p>Click <strong>lab-application</strong>.</p></li>
<li><p>Click <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Update</span> and configure:</p></li>
</ol><ul>
<li>Click <span style="font-weight:bold;background-color:#f1faff;font-size:90%;border-color:#00A1C9;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;"><i class="far fa-dot-circle" style="color:#007dbc;"></i> Replace current template</span>
</li>
<li>
<strong>Template source:</strong> <span style="font-weight:bold;background-color:#f1faff;font-size:90%;border-color:#00A1C9;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;"><i class="far fa-dot-circle" style="color:#007dbc;"></i> Upload a template file</span>
</li>
<li>
<strong>Upload a template file:</strong> Click <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Choose file</span> then select the <strong>lab-application2.yaml</strong> file you downloaded.</li>
</ul><ol start="28">
<li>Click <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space: nowrap;">Next</span> <strong>three times</strong> to advance to the <strong>Review</strong> page.</li>
</ol>
<p>In the <strong>Change set preview</strong> section at the bottom of the page, CloudFormation will display what resources need to be updated:</p>

<p><img src="./AWS - Lab 5 - Automating Infrastructure Deployment with AWS CloudFormation_files/change-set-preview.png" alt="Change set preview"></p>

<p>This is indicating that CloudFormation will <strong>Modify</strong> the Web Server security group without needing to replace it (<em>Replacement = False</em>). This means there will be a minor change to the Security Group and no references to the security group will need to change.</p>
<ol start="29">
<li><p>Click <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space: nowrap;">Update stack</span></p></li>
<li><p>Wait for the <strong>Status</strong> (in the <em>Stack info</em> tab) to change to <span style="color: green;"><i class="far fa-check-circle"></i>&nbsp;CREATE_COMPLETE</span>.</p></li>
</ol>
<p><i class="fas fa-comment"></i> Click Refresh <i class="fas fa-redo"></i> every 15 seconds to update the status if necessary.</p>

<p>You can now verify the change.</p>
<ol start="31">
<li>Return to the <strong>EC2</strong> console and select the <strong>Web Server security group</strong>.</li>
</ol>
<p>The <strong>Inbound</strong> tab should display an additional rule for <em>SSH</em> traffic.</p>

<p>This demonstrates how changes can be deployed in a repeatable, documented process. The CloudFormation template can be stored in a Source Code Repository (eg AWS CodeCommit) to maintain a history of the template and the infrastructure that has been deployed.</p>



<h2 id="step5">Task 4: Explore Templates with AWS CloudFormation Designer</h2>

<p><strong>AWS CloudFormation Designer</strong> is a graphic tool for creating, viewing, and modifying AWS CloudFormation templates. With Designer, you can diagram your template resources using a drag-and-drop interface, and then edit their details using the integrated JSON and YAML editor. Whether you are a new or an experienced AWS CloudFormation user, AWS CloudFormation Designer can help you quickly see the interrelationship between a template's resources and easily modify templates.</p>

<p>In this task, you will gain some hands-on experience with the Designer.</p>
<ol start="32">
<li><p>On the <span style="background-color:#232f3e;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Services <i class="fas fa-angle-down"></i></span> menu, click <strong>CloudFormation</strong>.</p></li>
<li><p>In the left navigation pane, click <strong>Designer</strong>.</p></li>
<li><p>Use the File <i class="fas fa-file"></i> menu to open a <strong>Local file</strong> and select the <strong>lab-application2.yaml</strong> template you downloaded previously.</p></li>
</ol>
<p>Designer will display a graphical representation of the template:</p>

<p><img src="./AWS - Lab 5 - Automating Infrastructure Deployment with AWS CloudFormation_files/designer.png" alt="CloudFormation Designer"></p>

<p>Rather than drawing a typical architecture diagram, Designer is a visual editor for CloudFormation templates so it draws the resources defined in a template and their relationships to each other.</p>
<ol start="35">
<li>Experiment with the features of the Designer. Some things to try are:</li>
</ol><ul>
<li>Click on the displayed resources. The lower pane will then display the portion of the template that defines the resources.</li>
<li>Try dragging a new resource from the <strong>Resource Types</strong> pane on the left into the design area. The definition of the resource will be automatically inserted into the template.</li>
<li>Try dragging the resource connector circles to create relationships between resources</li>
<li>Open the <strong>lab-network.yaml</strong> template you downloaded earlier in the lab and explore its resources too</li>
</ul>


<h2 id="step6">Task 5: Delete the Stack</h2>

<p>When resources are no longer required, CloudFormation can delete the resources built for the stack.</p>

<p>A <strong>Deletion Policy</strong> can also be specified against resources, which can preserve or (in some cases) backup a resource when its stack is deleted. This is useful for retaining databases, disk volumes or any resource that might be required after stack deletion.</p>

<p>The <em>lab-application</em> stack has been configured to take a snapshot of an Amazon EBS disk volume before it is deleted:</p>
<pre class="highlight yaml"><code>  <span class="na">DiskVolume</span><span class="pi">:</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">AWS::EC2::Volume</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">Size</span><span class="pi">:</span> <span class="s">100</span>
      <span class="na">AvailabilityZone</span><span class="pi">:</span> <span class="kt">!GetAtt</span> <span class="s">WebServerInstance.AvailabilityZone</span>
      <span class="na">Tags</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="na">Key</span><span class="pi">:</span> <span class="s">Name</span>
          <span class="na">Value</span><span class="pi">:</span> <span class="s">Web Data</span>
    <span class="na">DeletionPolicy</span><span class="pi">:</span> <span class="s">Snapshot</span>
</code><button class="button button--copy js-copy-button-3"><i class="fa fa-clipboard"></i></button></pre>
<p>The <em>DeletionPolicy</em> in the final line is directing CloudFormation to create a snapshot of the disk volume before it is deleted.</p>

<p>You will now delete the <em>lab-application</em> stack and see the results of this Deletion Policy.</p>
<ol start="36">
<li><p>Return to the main CloudFormation console by clicking the <span style="color:#1166bb;">Close</span> link at the top of the page.</p></li>
<li><p>Click <strong>lab-application</strong>.</p></li>
<li><p>Click <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Delete</span>.</p></li>
<li><p>Click <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space: nowrap;">Delete stack</span></p></li>
</ol>
<p>You can monitor the deletion process in the <strong>Events</strong> tab and update the screen by clicking Refresh <i class="fas fa-redo"></i> occasionally. You might also see a reference to the EBS snapshot being created.</p>
<ol start="40">
<li>Wait for the stack to be deleted. It will disappear from the list.</li>
</ol>
<p>The application stack has been removed, but the network stack has remained untouched. This reinforces the idea that different teams (eg network team, application team) can manage their own stacks.</p>

<p>You will now check that a snapshot was created of the EBS volume before it was deleted.</p>
<ol start="41">
<li><p>On the <span style="background-color:#232f3e;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Services <i class="fas fa-angle-down"></i></span> menu, click <strong>EC2</strong>.</p></li>
<li><p>In the left navigation pane, click <strong>Snapshots</strong>.</p></li>
</ol>
<p>You should see a snapshot with a <strong>Started</strong> time in the last few minutes.</p>



<h2 id="step7">Lab Complete</h2>

<p><i class="icon-flag-checkered"></i> Congratulations! You have completed the lab.</p>

<h2 id="step8">End Lab</h2>

<p>Follow these steps to close the console, end your lab, and evaluate the experience.</p>
<ol start="43">
<li><p>Return to the AWS Management Console.</p></li>
<li><p>On the navigation bar, click <strong>awsstudent@&lt;AccountNumber&gt;</strong>, and then click <strong>Sign Out</strong>.</p></li>
<li><p>Click <span style="background-color:#D93025;font-family:Google Sans;font-weight:bold;font-size:90%;color:white;border-color:#D93025;border-radius:4px;border-width:2px;border-style:solid;padding-top:5px;padding-bottom:5px;padding-left:10px;padding-right:10px;">End Lab</span></p></li>
<li><p>Click <span style="background-color:#DEDEDE;font-family:Google Sans;font-weight:bold;font-size:90%;color:#444;border-width:1px;border-style:solid;border-color:#444;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">OK</span></p></li>
<li><p>(Optional):</p></li>
</ol><ul>
<li>Select the applicable number of stars <i class="far fa-star"></i>
</li>
<li>Type a comment</li>
<li>
<p>Click <strong>Submit</strong></p>
<ul>
<li>1 star = Very dissatisfied</li>
<li>2 stars = Dissatisfied</li>
<li>3 stars = Neutral</li>
<li>4 stars = Satisfied</li>
<li>5 stars = Very satisfied</li>
</ul>
</li>
</ul>
<p>You may close the dialog if you don't want to provide feedback.</p>

</div>
<div class="js-lab-content-outline lab-content__outline is-stuck" style="">
<a href="https://china-aws.qwiklabs.com/classrooms/30842/labs/166977#step1" class="">Start Lab</a><a href="https://china-aws.qwiklabs.com/classrooms/30842/labs/166977#step2" class="">Task 1: Deploy a Networking Layer</a><a href="https://china-aws.qwiklabs.com/classrooms/30842/labs/166977#step3" class="">Task 2: Deploy an Application Layer</a><a href="https://china-aws.qwiklabs.com/classrooms/30842/labs/166977#step4">Task 3: Update a Stack</a><a href="https://china-aws.qwiklabs.com/classrooms/30842/labs/166977#step5">Task 4: Explore Templates with AWS CloudFormation Designer</a><a href="https://china-aws.qwiklabs.com/classrooms/30842/labs/166977#step6">Task 5: Delete the Stack</a><a href="https://china-aws.qwiklabs.com/classrooms/30842/labs/166977#step7">Lab Complete</a><a href="https://china-aws.qwiklabs.com/classrooms/30842/labs/166977#step8">End Lab</a>
</div>
</div>

</div>


</div>
</div>
<div class="lab-introduction js-lab-introduction is-hidden">
<div class="lab-introduction__inner">
<h1 class="headline-1">Welcome to Your First Lab!</h1>
<ql-icon-button class="js-skip-button">close</ql-icon-button>
<div class="lab-introduction__video">
<iframe allow="autoplay; encrypted-media" allowfullscreen="" frameborder="0" id="lab-introduction" src="./AWS - Lab 5 - Automating Infrastructure Deployment with AWS CloudFormation_files/yF7EDXKTmoQ.html"></iframe>
</div>
<a class="js-skip-button button button--outline">Skip this video</a>
</div>
</div>



</div>
</main>
<div class="modal fade" id="lab-details-modal">
<div class="modal-container" style="">
<div class="mdl-shadow--24dp modal-content">
<div class="modal-body">
<p class="l-mbm">
This lab shows how to deploy AWS infrastructure using AWS CloudFormation.
</p>
<p class="small-label l-mbs">
<strong>
持续时间：
</strong>
0建立
·
120时间允许
·
120为期
</p>
<p class="small-label l-mbs">
<strong>亚马逊网络服务系统区域：</strong>
[us-west-2] <strong>US West (Oregon)</strong>
</p>
<p class="small-label l-mbs">

</p>
<p class="small-label">
<strong>
Permalink:
</strong>
<a href="https://china-aws.qwiklabs.com/catalog_lab/5105">https://china-aws.qwiklabs.com/catalog_lab/5105</a>
</p>
</div>
<div class="modal-actions">
<a class="mdl-button mdl-button--primary mdl-js-button mdl-js-ripple-effect" data-dismiss="modal" data-upgraded=",MaterialButton,MaterialRipple">
Got It
<span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span></a>
</div>


</div>
</div>
<iframe class="l-ie-iframe-fix" src="./AWS - Lab 5 - Automating Infrastructure Deployment with AWS CloudFormation_files/saved_resource(1).html"></iframe>
</div>
<div class="modal fade" id="lab-review-modal">
<div class="modal-container" style="">
<div class="mdl-shadow--24dp modal-content">
<form class="simple_form js-lab-review-form" id="new_lab_review" action="https://china-aws.qwiklabs.com/lab_reviews" accept-charset="UTF-8" data-remote="true" method="post"><input name="utf8" type="hidden" value="✓"><div class="modal-body">
<p class="label">
你对这实验练习感到满意吗？
</p>
<div class="rateit js-rateit" data-rateit-max="5" data-rateit-min="0" data-rateit-resetable="false" data-rateit-step="1" data-rateit-value="0"><div class="rateit-reset" style="display: none;"></div><div class="rateit-range" style="width: 80px; height: 16px;"><div class="rateit-selected" style="height: 16px; width: 0px;"></div><div class="rateit-hover" style="height:16px"></div></div></div>
<div class="l-mtm">

<div class="control-group hidden lab_review_user_id"><div class="controls"><input class="hidden" type="hidden" value="318010" name="lab_review[user_id]" id="lab_review_user_id"></div></div>
<div class="control-group hidden lab_review_classroom_id"><div class="controls"><input class="hidden" type="hidden" value="30842" name="lab_review[classroom_id]" id="lab_review_classroom_id"></div></div>
<div class="control-group hidden lab_review_lab_id"><div class="controls"><input class="hidden" type="hidden" value="5105" name="lab_review[lab_id]" id="lab_review_lab_id"></div></div>
<div class="control-group hidden lab_review_focus_id"><div class="controls"><input class="hidden" type="hidden" value="166977" name="lab_review[focus_id]" id="lab_review_focus_id"></div></div>
<div class="control-group hidden lab_review_rating"><div class="controls"><input class="hidden js-rating-input" type="hidden" name="lab_review[rating]" id="lab_review_rating"></div></div>
<div class="control-group text optional lab_review_comment"><label class="text optional control-label" for="lab_review_comment">评论</label><div class="controls"><textarea class="text optional" name="lab_review[comment]" id="lab_review_comment"></textarea></div></div>
</div>
</div>
<div class="modal-actions">
<a class="mdl-button mdl-button--primary mdl-js-button mdl-js-ripple-effect" data-dismiss="modal" data-upgraded=",MaterialButton,MaterialRipple">
Cancel
<span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span></a>
<input type="submit" name="commit" value="提交" disabled="disabled" class="btn mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--primary" id="submit" data-disabled="false" data-disable-with="提交" data-upgraded=",MaterialButton,MaterialRipple"><span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span></input>
</div>
</form>

</div>
</div>
<iframe class="l-ie-iframe-fix" src="./AWS - Lab 5 - Automating Infrastructure Deployment with AWS CloudFormation_files/saved_resource(2).html"></iframe>
</div>

<script>
  $( function() {
    ql.initMaterialInputs();
    initChosen();
    initSearch();
    initTabs();
    ql.list.init();
    ql.favoriting.init();
    ql.header.myAccount.init();
    initTooltips();
    ql.autocomplete.init();
    ql.modals.init();
    ql.toggleButtons.init();
    ql.analytics.init();
    initLabContent( );
  ql.labOutline.links.init();
  ql.labOutline.layout.init();
  initLabReviewModal();
  ql.labAssessment.init();
  ql.labData.init();
  initLabTranslations( {"are_you_sure":"全部做完了？如果您结束此实验练习，您将失去所有的工作。如果配额限制存在，您可能无法重新启动此实验练习。您确定您要结束此实验练习？\n","in_progress":"*进行中*","ending":"*结束*","starting":"*正在启动，请稍候*","end_concurrent_labs":"对不起，你只能在同一时间运行一个实验练习。要开始这个实验练习，请确认您希望把全部现有的实验练习结束。\n","copied":"复制完成","no_resource":"获取资源时有错误。","no_support":"没有支援 :(","mac_press":"按⌘-C复制","thanks_review":"感谢审阅了此实验练习。","windows_press":"按Ctrl-C复制","days":"天"} );
  ql.labRun.init();
  ql.initHeader();
  ql.navigation.init();
  ql.navPanel.init();
  ql.navigation.init();
  
  });
</script>
<style>
  .mdl-layout__container {
    position: static
  }
</style>


<iframe data-product="web_widget" title="No content" tabindex="-1" aria-hidden="true" src="./AWS - Lab 5 - Automating Infrastructure Deployment with AWS CloudFormation_files/saved_resource(3).html" style="width: 0px; height: 0px; border: 0px; position: absolute; top: -9999px;"></iframe><div><iframe title="Opens a widget where you can chat to one of our agents" id="launcher" tabindex="0" class="zEWidget-launcher zEWidget-launcher--active" style="border: none; background: transparent; z-index: 999998; transform: translateZ(0px); position: fixed; transition-duration: 250ms; transition-timing-function: cubic-bezier(0.645, 0.045, 0.355, 1); transition-property: opacity, top, bottom; opacity: 1; height: 50px; max-height: 551px; min-height: 50px; margin: 10px 20px; right: 0px; bottom: 0px; width: 114px;" src="./AWS - Lab 5 - Automating Infrastructure Deployment with AWS CloudFormation_files/saved_resource(4).html"></iframe></div><div><iframe title="Find more information here" id="webWidget" tabindex="-1" class="zEWidget-webWidget " style="border: none; background: transparent; z-index: 999999; transform: translateZ(0px); position: fixed; transition-duration: 250ms; transition-timing-function: cubic-bezier(0.645, 0.045, 0.355, 1); transition-property: opacity, top, bottom; opacity: 0; width: 357px; height: 100%; max-height: 565px; min-height: 150px; margin-left: 8px; margin-right: 8px; top: -9999px; visibility: hidden;" src="./AWS - Lab 5 - Automating Infrastructure Deployment with AWS CloudFormation_files/saved_resource(5).html"></iframe></div></body></html>